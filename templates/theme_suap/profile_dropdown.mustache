  <style>
    /* container do botão + menu */
    .dropdown-accordion {
      position: relative;
      display: inline-block;

        /* botão de três pontinhos */
        .dropdown-btn {
            height: 100%;
            color: var(--dark);
            background-color: var(--light);
            border-radius: 1rem;
            border: none;
            padding: 6px;
            display: flex;
            align-items: center;
            font-size: 20px;
            cursor: pointer;
            transition: color 0.15s ease-in-out,background-color 0.15s ease-in-out,border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out;
            &:hover, &[aria-expanded="true"] {
                background-color: var(--light-dark);
            }
        }

        /* dropdown absoluto */
        .dropdown-menu {
            display: none;              /* escondido por padrão */
            position: absolute;
            top: 100%;                  /* logo abaixo do botão */
            right: 0;
            background: #fff;
            border: 1px solid #ccc;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            z-index: 100;
            width: 200px;
        }
        .dropdown-menu.show {
            display: block;
        }

        /* estilo básico do menu */
        .menu,
        .submenu {
        list-style: none;
        padding: 0;
        margin: 0;
        }

        .menu > li {
            margin-bottom: 2px;
            cursor: pointer;
            padding: 10px;
            position: relative;
            a {
                color: var(--dark);
                text-decoration: none;
            }
        }

        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .menu > li.open .submenu {
        max-height: 500px;
        transition: max-height 0.5s ease-in;
        }
        .menu > li .arrow {
        float: right;
        transition: transform 0.3s;
        }
        .menu > li.open .arrow {
        transform: rotate(90deg);
        }
    }

  </style>

<div class="dropdown-accordion">
  <button class="dropdown-btn" aria-label="Abrir menu">
    <i class="icon fa fa-ellipsis-v fa-fw m-0"></i>
  </button>
  <div class="dropdown-menu dropdown-menu-right">
    <ul class="menu">
      {{#categories}}
      <li class="item-dropdown">
        {{title}}
        <i class="fa-solid fa-chevron-right arrow"></i>
        {{#nodes}}
          {{#first}}<ul class="submenu">{{/first}}
            {{#url}}
            <li class="dropdown-item">
              <a href="{{{url}}}">{{text}}</a>
            </li>
            {{/url}}
          {{#last}}</ul>{{/last}}
        {{/nodes}}
      </li>
      {{/categories}}
    </ul>
  </div>
</div>

<script>
  const container = document.querySelector('.dropdown-accordion');
  const btn = container.querySelector('.dropdown-btn');
  const dropdown = container.querySelector('.dropdown-menu');

  // abre/fecha o menu ao clicar no botão
  btn.addEventListener('click', e => {
    e.stopPropagation();
    const aberto = dropdown.classList.toggle('show');
    btn.setAttribute('aria-expanded', aberto);
  });

  // fecha o menu ao clicar fora
  document.addEventListener('click', () => {
    dropdown.classList.remove('show');
    btn.setAttribute('aria-expanded', 'false');
  });

  // accordion interno
  dropdown.querySelectorAll('.menu > li').forEach(item => {
    const submenu = item.querySelector('.submenu');
    if (!submenu) return;

    item.addEventListener('click', e => {
      e.stopPropagation(); // não fecha o dropdown
      // fecha os outros
      dropdown.querySelectorAll('.menu > li.open')
        .forEach(openItem => {
          if (openItem !== item) openItem.classList.remove('open');
        });
      // alterna o clicado
      item.classList.toggle('open');
    });
  });
</script>